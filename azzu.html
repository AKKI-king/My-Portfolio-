<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AZZUL — Multi-Tool Web App</title>
  <meta name="description" content="Azzu Tools: a fast, modern, responsive multi-tool website (calculator, converters, encoders, formatters, generators, timers, notes, and more) built with pure HTML/CSS/JS." />

  <!--
    Tools Pack
    Tech: Pure HTML + CSS + Vanilla JS (no frameworks / no external libs)
    Theme: Dark premium minimal — smooth transitions; responsive grid/cards; a11y friendly.
    Tip: Use Ctrl/Cmd + K for the Command Palette. Use the global search above the grid to filter tools.
  -->

  <style>
    :root{
      --bg:#1E1E2F;           /* dark navy background */
      --bg-elev:#23233a;
      --card:#24243b;
      --card-2:#2b2b45;
      --text:#EDEDF3;
      --muted:#B7B7C9;
      --accent:#7C88FF;
      --accent-2:#22d3ee;
      --danger:#ff6b6b;
      --success:#22c55e;
      --warning:#f59e0b;
      --border:rgba(255,255,255,.08);
      --shadow:0 10px 30px rgba(0,0,0,.35);
      --radius:16px;
      --radius-sm:12px;
      --radius-xs:10px;
      --focus:0 0 0 3px rgba(124,136,255,.35), 0 0 0 1px var(--accent);
      --transition: 180ms ease;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    *{box-sizing: border-box}
    html,body{height:100%}
    body{
      margin:0;background:radial-gradient(1200px 600px at 120% -10%,rgba(124,136,255,.12),transparent 55%),
                       radial-gradient(800px 400px at -10% 120%,rgba(34,211,238,.10),transparent 60%),
                       var(--bg);
      color:var(--text);font:16px/1.5 var(--sans); letter-spacing:.2px;
      -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
    }

    a{color:var(--accent);text-decoration:none}
    a:hover{text-decoration:underline}

    .container{max-width:1200px;margin:0 auto;padding:24px}
    header{
      position:sticky;top:0;z-index:10;
      backdrop-filter:saturate(140%) blur(8px);
      background:linear-gradient(to bottom, rgba(30,30,47,.85), rgba(30,30,47,.65) 60%, transparent);
      border-bottom:1px solid var(--border);
    }
    .brand{
      display:flex;align-items:center;gap:12px;
      padding:10px 0 6px;
    }
    .logo{
      width:36px;height:36px;border-radius:10px;
      background: conic-gradient(from 180deg at 50% 50%, var(--accent), var(--accent-2), var(--accent));
      box-shadow:inset 0 0 0 4px rgba(0,0,0,.25), var(--shadow);
    }
    .title{font-weight:700;letter-spacing:.5px;font-size:1.25rem}
    .subtitle{color:var(--muted);font-size:.92rem}

    .toolbar{
      display:grid;grid-template-columns: 1fr auto;gap:12px;margin:14px 0 10px;
    }

    .search{
      display:flex;align-items:center;gap:10px;
      background:var(--card);border:1px solid var(--border);
      padding:10px 14px;border-radius:999px; box-shadow: var(--shadow);
      transition: box-shadow var(--transition), border-color var(--transition), background var(--transition);
    }
    .search:focus-within{box-shadow:var(--focus)}
    .search input{
      flex:1;border:0;outline:0;background:transparent;color:var(--text);font-size:.98rem;
    }
    .kbd{
      font: 12px var(--mono);color:var(--muted);
      border:1px solid var(--border);padding:2px 8px;border-radius:6px;background:var(--bg-elev)
    }
    .paletteBtn{
      border:1px solid var(--border);background:var(--card);
      padding:10px 14px;border-radius:12px;color:var(--text);cursor:pointer;
      transition:transform var(--transition), background var(--transition), border-color var(--transition);
    }
    .paletteBtn:hover{transform:translateY(-1px);background:var(--card-2)}
    .grid{
      display:grid;gap:16px;margin:10px 0 40px;
      grid-template-columns: repeat(12, 1fr);
    }
    @media (max-width:1200px){.grid{grid-template-columns: repeat(8, 1fr)}}
    @media (max-width:900px){.grid{grid-template-columns: repeat(6, 1fr)}}
    @media (max-width:720px){.grid{grid-template-columns: repeat(4, 1fr)}}
    @media (max-width:520px){.grid{grid-template-columns: repeat(2, 1fr)}}

    .card{
      grid-column: span 6;
      background:linear-gradient(180deg, rgba(255,255,255,.02), transparent 60%), var(--card);
      border:1px solid var(--border); border-radius: var(--radius);
      box-shadow: var(--shadow); padding:16px; display:flex; flex-direction:column; gap:12px;
      min-height: 200px; position:relative; overflow:hidden; transition: transform var(--transition), border-color var(--transition), background var(--transition);
    }
    .card:hover{transform: translateY(-2px)}
    .card.compact{grid-column: span 4; min-height:180px}
    .card.full{grid-column: span 12}
    .card h3{margin:0 0 8px;font-size:1.05rem;letter-spacing:.3px}
    .muted{color:var(--muted);font-size:.9rem}

    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .row > *{flex:1 1 auto}
    .btn{
      background:linear-gradient(180deg, rgba(255,255,255,.06), transparent), var(--card-2);
      border:1px solid var(--border); color:var(--text); padding:10px 12px; border-radius:12px; cursor:pointer;
      transition:transform var(--transition), background var(--transition), border-color var(--transition);
    }
    .btn:hover{background:var(--card)}
    .btn:active{transform:translateY(1px)}
    .btn.primary{background:linear-gradient(180deg, rgba(124,136,255,.15), transparent), var(--card-2); border-color: rgba(124,136,255,.5)}
    .btn.danger{background:linear-gradient(180deg, rgba(255,107,107,.2), transparent), var(--card-2); border-color: rgba(255,107,107,.5)}
    .btn.success{background:linear-gradient(180deg, rgba(34,197,94,.2), transparent), var(--card-2); border-color: rgba(34,197,94,.5)}

    .input, select, textarea{
      width:100%; background:var(--bg-elev); color:var(--text); border:1px solid var(--border);
      border-radius:12px; padding:10px 12px; outline:none; transition: box-shadow var(--transition), border-color var(--transition), background var(--transition);
    }
    .input:focus, select:focus, textarea:focus{box-shadow:var(--focus)}
    textarea{min-height:120px; resize:vertical}
    code, pre{font-family:var(--mono)}

    .copy{
      position:absolute; top:12px; right:12px;
      border:1px solid var(--border); background:var(--bg-elev); border-radius:10px; padding:6px 8px; cursor:pointer; color:var(--muted); font:12px var(--mono)
    }
    .pill{
      display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;border:1px solid var(--border);
      background:var(--bg-elev);color:var(--muted);font:12px var(--mono)
    }
    .stat{font-weight:700}
    .preview{
      background:var(--bg-elev); padding:12px; border-radius:12px; border:1px solid var(--border);
    }

    /* Command Palette */
    .modal{
      position:fixed; inset:0; display:none; align-items:flex-start; justify-content:center; padding-top:10vh;
      background:rgba(0,0,0,.45); z-index:99;
    }
    .modal[open]{display:flex}
    .palette{
      width:min(680px, 92vw); background:var(--card); border:1px solid var(--border); border-radius:16px; box-shadow: var(--shadow);
      overflow:hidden;
    }
    .palette .head{padding:12px;border-bottom:1px solid var(--border)}
    .palette input{background:var(--bg-elev); border-radius:10px; padding:12px; border:1px solid var(--border); width:100%; color:var(--text)}
    .palette .list{max-height:50vh; overflow:auto}
    .palette .item{
      padding:12px 14px; border-bottom:1px solid var(--border); cursor:pointer; display:flex; justify-content:space-between; align-items:center;
    }
    .palette .item[aria-selected="true"]{background:rgba(124,136,255,.15)}
    .sr-only{position:absolute !important;width:1px;height:1px;overflow:hidden;clip:rect(1px,1px,1px,1px);white-space:nowrap}

    /* Ads placeholder */
    .ads{display:grid;grid-template-columns:repeat(12,1fr);gap:16px;margin:6px 0 22px}
    .ad-slot{grid-column:span 12;background:linear-gradient(180deg, rgba(255,255,255,.04), transparent), var(--bg-elev);
      border:1px dashed var(--border); border-radius:var(--radius); padding:18px; text-align:center; color:var(--muted)}
    .ad-slot.small{grid-column:span 6}
    @media (max-width:720px){.ad-slot.small{grid-column:span 12}}

    /* Tiny helpers */
    .note{color:var(--muted);font-size:.85rem}
    .range{accent-color: var(--accent)}
    .hidden{display:none !important}
  </style>
</head>

<body>
  <header>
    <div class="container">
      <div class="brand" aria-label="Tools Pack header">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <div class="title">Tools Pack</div>
          <div class="subtitle">A fast, modern, privacy-friendly toolbox — all offline.</div>
        </div>
      </div>

      <div class="toolbar" role="search">
        <label class="search" aria-label="Filter tools">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M15.5 15.5L21 21" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><circle cx="10" cy="10" r="7" stroke="currentColor" stroke-width="2"/></svg>
          <input id="globalSearch" class="input" placeholder="Search tools… (Try: json, hash, color, notes)" autocomplete="off" aria-controls="toolsGrid" />
          <span class="kbd" aria-hidden="true">Ctrl/Cmd + K</span>
        </label>
        <button class="paletteBtn" id="openPalette" aria-haspopup="dialog" aria-controls="paletteModal">Open Command Palette</button>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- Google Ads Ready (No external script loaded) -->
    <section class="ads" aria-label="Advertisement">
      <div class="ad-slot" aria-label="Ad slot leader">
        <!-- Google AdSense placeholder. When ready, paste your AdSense script and ins element below.
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=YOUR_ID" crossorigin="anonymous"></script>
        <ins class="adsbygoogle" style="display:block" data-ad-client="YOUR_ID" data-ad-slot="XXXX" data-ad-format="auto" data-full-width-responsive="true"></ins>
        <script>(adsbygoogle=window.adsbygoogle||[]).push({});</script>
        -->
        <span class="note">Ad slot — paste AdSense code here when you’re ready.</span>
      </div>
    </section>

    <!-- Tools Grid -->
    <section id="toolsGrid" class="grid" aria-label="Tools grid">
      <!-- 1. Calculator -->
      <article class="card compact" data-tags="math,calculator,calc" id="tool-calculator" tabindex="0" aria-labelledby="calc-title">
        <h3 id="calc-title">Calculator</h3>
        <div class="row">
          <input aria-label="Expression" id="calcExpr" class="input" placeholder="e.g., (12 + 3) * 4 / 2" />
          <button class="btn primary" id="calcEval">Evaluate</button>
        </div>
        <div class="preview" id="calcOut" aria-live="polite" role="status">Result: <span class="stat">—</span></div>
        <div class="note">Supports + − × ÷ ( ) and decimals. Keyboard: Enter to evaluate.</div>
      </article>

      <!-- 2. Unit Converter -->
      <article class="card" data-tags="unit,converter,length,weight,temperature,convert" id="tool-unit" aria-labelledby="unit-title" tabindex="0">
        <h3 id="unit-title">Unit Converter</h3>
        <div class="row">
          <select id="unitType" aria-label="Conversion type">
            <option value="length">Length</option>
            <option value="weight">Weight</option>
            <option value="temperature">Temperature</option>
          </select>
          <input id="unitInput" class="input" type="number" step="any" placeholder="Enter value" aria-label="Input value" />
        </div>
        <div class="row">
          <select id="unitFrom" aria-label="From unit"></select>
          <select id="unitTo" aria-label="To unit"></select>
          <button id="unitSwap" class="btn" aria-label="Swap units">Swap</button>
          <button id="unitConvert" class="btn primary">Convert</button>
        </div>
        <div class="preview" id="unitOut" aria-live="polite">—</div>
        <div class="note">Length: m, km, cm, mm, in, ft, yd, mi • Weight: g, kg, lb, oz • Temperature: °C, °F, K</div>
      </article>

      <!-- 3. Text Utilities -->
      <article class="card full" data-tags="text,case,word count,spaces,letters" id="tool-text" aria-labelledby="text-title" tabindex="0">
        <h3 id="text-title">Text Utilities</h3>
        <div class="row">
          <textarea id="textInput" placeholder="Paste or type your text…" aria-label="Text input"></textarea>
        </div>
        <div class="row">
          <button class="btn" id="toUpper">UPPERCASE</button>
          <button class="btn" id="toLower">lowercase</button>
          <button class="btn" id="trimSpaces">Trim & Remove Extra Spaces</button>
          <button class="btn" id="wordCount">Word/Char Count</button>
          <button class="btn" id="reverseText">Reverse Lines</button>
          <button class="btn" id="copyText">Copy</button>
        </div>
        <div class="preview" id="textStats" aria-live="polite">Words: 0 • Characters: 0 • Lines: 0</div>
      </article>

      <!-- 4. Base64 Encode/Decode -->
      <article class="card" data-tags="base64,encode,decode" id="tool-b64" aria-labelledby="b64-title" tabindex="0">
        <h3 id="b64-title">Base64 Encode / Decode</h3>
        <textarea id="b64In" placeholder="Enter text…"></textarea>
        <div class="row">
          <button class="btn" id="b64Encode">Encode</button>
          <button class="btn" id="b64Decode">Decode</button>
          <button class="btn" id="b64Clear">Clear</button>
          <button class="btn" id="b64Copy">Copy</button>
        </div>
        <textarea id="b64Out" placeholder="Output…" aria-label="Base64 output"></textarea>
        <div class="note">UTF-8 safe.</div>
      </article>

      <!-- 5. URL Encoder/Decoder -->
      <article class="card" data-tags="url,encode,decode,uri" id="tool-url" aria-labelledby="url-title" tabindex="0">
        <h3 id="url-title">URL Encoder / Decoder</h3>
        <textarea id="urlIn" placeholder="Enter URL or text…"></textarea>
        <div class="row">
          <button class="btn" id="urlEncode">Encode</button>
          <button class="btn" id="urlDecode">Decode</button>
          <button class="btn" id="urlCopy">Copy Output</button>
        </div>
        <textarea id="urlOut" placeholder="Output…" aria-label="URL output"></textarea>
      </article>

      <!-- 6. JSON Formatter/Validator -->
      <article class="card full" data-tags="json,formatter,validator,beautify" id="tool-json" aria-labelledby="json-title" tabindex="0">
        <h3 id="json-title">JSON Formatter & Validator</h3>
        <div class="row">
          <textarea id="jsonIn" placeholder='Paste JSON here…'></textarea>
        </div>
        <div class="row">
          <button class="btn primary" id="jsonFormat">Format</button>
          <button class="btn" id="jsonMinify">Minify</button>
          <button class="btn" id="jsonValidate">Validate</button>
          <button class="btn" id="jsonCopy">Copy</button>
          <button class="btn danger" id="jsonClear">Clear</button>
        </div>
        <pre class="preview" id="jsonOut" role="region" aria-live="polite" style="white-space:pre-wrap"></pre>
      </article>

      <!-- 7. Password Generator -->
      <article class="card" data-tags="password,security,generator" id="tool-pass" aria-labelledby="pass-title" tabindex="0">
        <h3 id="pass-title">Password Generator</h3>
        <div class="row">
          <label class="pill">Length <input id="passLen" type="range" min="6" max="64" value="16" class="range" aria-label="Password length"></label>
          <span id="passLenVal" class="pill">16</span>
        </div>
        <div class="row">
          <label class="pill"><input type="checkbox" id="passLower" checked> a-z</label>
          <label class="pill"><input type="checkbox" id="passUpper" checked> A-Z</label>
          <label class="pill"><input type="checkbox" id="passNum" checked> 0-9</label>
          <label class="pill"><input type="checkbox" id="passSym"> Symbols</label>
          <label class="pill"><input type="checkbox" id="passAmbig"> Avoid ambiguous</label>
        </div>
        <div class="row">
          <input id="passOut" class="input" readonly aria-label="Generated password" />
          <button class="btn primary" id="passGen">Generate</button>
          <button class="btn" id="passCopy">Copy</button>
        </div>
        <div id="passStrength" class="note">Strength: —</div>
      </article>

      <!-- 8. UUID v4 -->
      <article class="card compact" data-tags="uuid,id,generator,random" id="tool-uuid" aria-labelledby="uuid-title" tabindex="0">
        <h3 id="uuid-title">UUID v4 Generator</h3>
        <div class="row">
          <input id="uuidOut" class="input" readonly aria-label="UUID output" />
          <button class="btn primary" id="uuidGen">Generate</button>
          <button class="btn" id="uuidCopy">Copy</button>
        </div>
        <div class="note">Cryptographically secure using Web Crypto.</div>
      </article>

      <!-- 9. Hash Generator (SHA-256) -->
      <article class="card" data-tags="hash,sha256,crypto,checksum" id="tool-hash" aria-labelledby="hash-title" tabindex="0">
        <h3 id="hash-title">Hash Generator (SHA-256)</h3>
        <textarea id="hashIn" placeholder="Enter text to hash…"></textarea>
        <div class="row">
          <button class="btn primary" id="hashBtn">SHA-256</button>
          <button class="btn" id="hashCopy">Copy</button>
        </div>
        <input id="hashOut" class="input" readonly aria-label="SHA-256 output" />
      </article>

      <!-- 10. Image Resizer & Compressor -->
      <article class="card full" data-tags="image,resize,compress,canvas,photo,jpeg,png" id="tool-image" aria-labelledby="image-title" tabindex="0">
        <h3 id="image-title">Image Resizer & Compressor</h3>
        <div class="row">
          <input type="file" id="imgFile" accept="image/*" class="input" aria-label="Choose image" />
        </div>
        <div class="row">
          <label class="pill">Width <input id="imgW" type="number" min="1" class="input" style="width:120px"></label>
          <label class="pill">Height <input id="imgH" type="number" min="1" class="input" style="width:120px"></label>
          <label class="pill"><input type="checkbox" id="imgLock" checked> Keep aspect</label>
          <label class="pill">Quality <input id="imgQ" type="range" min="0.1" max="1" step="0.05" value="0.8" class="range"></label>
          <select id="imgType" aria-label="Output type">
            <option value="image/jpeg">JPEG</option>
            <option value="image/png">PNG</option>
            <option value="image/webp">WEBP</option>
          </select>
          <button class="btn primary" id="imgProcess">Process</button>
          <button class="btn" id="imgDownload" disabled>Download</button>
        </div>
        <div class="row">
          <div class="preview" style="flex:1"><div class="note">Original</div><img id="imgPreviewSrc" alt="Original preview" style="max-width:100%;border-radius:12px"/></div>
          <div class="preview" style="flex:1"><div class="note">Output</div><img id="imgPreviewOut" alt="Output preview" style="max-width:100%;border-radius:12px"/></div>
        </div>
        <canvas id="imgCanvas" class="hidden" aria-hidden="true"></canvas>
        <div id="imgMeta" class="note">—</div>
      </article>

      <!-- 11. Color Picker Contrast Checker -->
      <article class="card" data-tags="color,picker,contrast,accessibility,wcag" id="tool-color" aria-labelledby="color-title" tabindex="0">
        <h3 id="color-title">Color Picker + Contrast Checker</h3>
        <div class="row">
          <label class="pill">Foreground <input type="color" id="fgColor" value="#ffffff" aria-label="Foreground color"></label>
          <label class="pill">Background <input type="color" id="bgColor" value="#1E1E2F" aria-label="Background color"></label>
        </div>
        <div class="preview" id="contrastPreview" style="padding:16px;border-radius:12px;">
          <div id="sampleText" style="font-size:1.1rem">Aa — Sample Text</div>
        </div>
        <div id="contrastOut" class="note">Contrast: —</div>
      </article>

      <!-- 12. Stopwatch & Countdown Timer -->
      <article class="card" data-tags="time,timer,stopwatch,countdown,clock" id="tool-time" aria-labelledby="time-title" tabindex="0">
        <h3 id="time-title">Stopwatch & Countdown</h3>
        <div class="preview" style="text-align:center;font-size:1.6rem" id="stopwatchDisplay">00:00.00</div>
        <div class="row" style="justify-content:center">
          <button class="btn" id="swStart">Start</button>
          <button class="btn" id="swLap">Lap</button>
          <button class="btn" id="swStop">Stop</button>
          <button class="btn danger" id="swReset">Reset</button>
        </div>
        <div id="swLaps" class="note">Laps: —</div>
        <hr style="border-color:var(--border);opacity:.3">
        <div class="row">
          <label class="pill">Min <input type="number" id="cdMin" class="input" min="0" value="0" style="width:100px"></label>
          <label class="pill">Sec <input type="number" id="cdSec" class="input" min="0" value="10" style="width:100px"></label>
          <button class="btn primary" id="cdStart">Start Countdown</button>
          <button class="btn" id="cdPause">Pause</button>
          <button class="btn danger" id="cdReset">Reset</button>
        </div>
        <div class="preview" style="text-align:center;font-size:1.4rem" id="countdownDisplay">00:10</div>
      </article>

      <!-- 13. Quick Notes (localStorage) -->
      <article class="card full" data-tags="notes,note,localstorage,editor" id="tool-notes" aria-labelledby="notes-title" tabindex="0">
        <h3 id="notes-title">Quick Notes</h3>
        <div class="row">
          <input id="notesTitle" class="input" placeholder="Title (optional)" aria-label="Note title" />
        </div>
        <textarea id="notesArea" placeholder="Write notes… They are saved to your browser automatically." aria-label="Notes area"></textarea>
        <div class="row">
          <button class="btn" id="notesExport">Export</button>
          <input type="file" id="notesImport" accept="application/json" class="input" style="max-width:260px">
          <button class="btn danger" id="notesClear">Clear</button>
        </div>
        <div id="notesSaved" class="note">Autosaved.</div>
      </article>
    </section>

    <!-- Secondary ad slots -->
    <section class="ads" aria-label="Advertisement">
      <div class="ad-slot small">
        <span class="note">Ad slot — 300×250/Responsive.</span>
      </div>
      <div class="ad-slot small">
        <span class="note">Ad slot — 300×250/Responsive.</span>
      </div>
    </section>

  </main>

  <!-- Command Palette Modal -->
  <dialog id="paletteModal" class="modal" aria-label="Command palette" aria-modal="true">
    <div class="palette" role="listbox" aria-label="Tools">
      <div class="head">
        <input id="paletteInput" placeholder="Type to jump to a tool…" autocomplete="off" aria-label="Command palette input" />
      </div>
      <div id="paletteList" class="list"></div>
    </div>
  </dialog>

  <span class="sr-only" aria-live="polite" id="liveRegion"></span>

  <script>
  (function(){
    'use strict';

    /** -----------------------------
     * Utility Helpers
     * ------------------------------ */
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));
    const announce = (msg) => { const live = $('#liveRegion'); live.textContent = msg; };
    const copyToClipboard = async (text) => {
      try { await navigator.clipboard.writeText(text); toast('Copied'); }
      catch { fallbackCopy(text); }
    };
    function fallbackCopy(text){
      const ta = document.createElement('textarea');
      ta.value = text; document.body.appendChild(ta); ta.select();
      try { document.execCommand('copy'); toast('Copied'); } catch {}
      ta.remove();
    }
    function toast(msg){
      const t = document.createElement('div');
      t.textContent = msg;
      t.style.cssText = 'position:fixed;bottom:16px;left:50%;transform:translateX(-50%);background:#2b2b45;color:#fff;padding:10px 14px;border-radius:10px;border:1px solid rgba(255,255,255,.1);box-shadow:0 10px 30px rgba(0,0,0,.4);z-index:100';
      document.body.appendChild(t);
      setTimeout(()=>t.remove(),1200);
    }
    const clamp = (n, min, max) => Math.min(Math.max(n, min), max);

    /** -----------------------------
     * Global Search (filters tools)
     * ------------------------------ */
    const searchInput = $('#globalSearch');
    searchInput.addEventListener('input', () => {
      const q = searchInput.value.trim().toLowerCase();
      $$('#toolsGrid > .card').forEach(card => {
        const tags = (card.dataset.tags || '') + ' ' + (card.querySelector('h3')?.textContent || '');
        card.style.display = tags.toLowerCase().includes(q) ? '' : 'none';
      });
    });

    /** -----------------------------
     * Command Palette (Ctrl/Cmd + K)
     * ------------------------------ */
    const modal = $('#paletteModal');
    const openPaletteBtn = $('#openPalette');
    const paletteInput = $('#paletteInput');
    const paletteList = $('#paletteList');
    const cards = $$('#toolsGrid > .card');
    const tools = cards.map(c => ({
      id: c.id, title: c.querySelector('h3').textContent, tags: c.dataset.tags || ''
    }));

    function openPalette(){
      renderPalette('');
      modal.setAttribute('open','');
      paletteInput.value = '';
      setTimeout(()=> paletteInput.focus(), 0);
    }
    function closePalette(){ modal.removeAttribute('open'); openPaletteBtn.focus(); }

    function renderPalette(query){
      paletteList.innerHTML = '';
      const q = query.trim().toLowerCase();
      const filtered = tools.filter(t => (t.title + ' ' + t.tags).toLowerCase().includes(q));
      filtered.forEach((t,i)=>{
        const item = document.createElement('div');
        item.className = 'item';
        item.setAttribute('role','option');
        item.setAttribute('tabindex','-1');
        if(i===0) item.setAttribute('aria-selected','true');
        item.innerHTML = `<span>${t.title}</span><span class="kbd">Enter</span>`;
        item.addEventListener('click', ()=> jumpTo(t.id));
        paletteList.appendChild(item);
      });
      if(filtered.length===0){
        const none = document.createElement('div');
        none.className='item'; none.textContent='No results…';
        paletteList.appendChild(none);
      }
    }
    function jumpTo(id){
      closePalette();
      const el = document.getElementById(id);
      if(!el) return;
      el.scrollIntoView({behavior:'smooth', block:'center'});
      el.classList.add('highlight');
      setTimeout(()=> el.classList.remove('highlight'), 1200);
      el.focus({preventScroll:true});
    }
    openPaletteBtn.addEventListener('click', openPalette);
    document.addEventListener('keydown', (e)=>{
      if((e.ctrlKey || e.metaKey) && e.key.toLowerCase()==='k'){ e.preventDefault(); openPalette(); }
      if(e.key==='Escape' && modal.hasAttribute('open')){ e.preventDefault(); closePalette(); }
      if(modal.hasAttribute('open')){
        const items = $$('.item', paletteList).filter(i=>i.getAttribute('role')==='option');
        let idx = items.findIndex(i=>i.getAttribute('aria-selected')==='true');
        if(e.key==='ArrowDown'){ e.preventDefault(); idx = clamp(idx+1,0,items.length-1); items.forEach(i=>i.setAttribute('aria-selected','false')); items[idx]?.setAttribute('aria-selected','true'); items[idx]?.scrollIntoView({block:'nearest'}); }
        if(e.key==='ArrowUp'){ e.preventDefault(); idx = clamp(idx-1,0,items.length-1); items.forEach(i=>i.setAttribute('aria-selected','false')); items[idx]?.setAttribute('aria-selected','true'); items[idx]?.scrollIntoView({block:'nearest'}); }
        if(e.key==='Enter'){ e.preventDefault(); const sel = items.find(i=>i.getAttribute('aria-selected')==='true'); const text = sel?.querySelector('span')?.textContent; const found = tools.find(t=>t.title===text); if(found) jumpTo(found.id); }
      }
    });
    paletteInput.addEventListener('input', e => renderPalette(e.target.value));
    modal.addEventListener('click', (e)=> { if(e.target===modal) closePalette(); });

    /** -----------------------------
     * 1. Calculator
     * ------------------------------ */
    const calcExpr = $('#calcExpr'), calcOut = $('#calcOut .stat');
    function evaluate(){
      let expr = calcExpr.value.trim();
      if(!expr){ calcOut.textContent='—'; return; }
      expr = expr.replace(/×/g,'*').replace(/÷/g,'/'); // allow × ÷
      // Very safe evaluator: only digits, ops, parentheses, decimal, spaces
      if(!/^[0-9+\-*/().\s]+$/.test(expr)){ calcOut.textContent='Invalid characters'; return; }
      try{
        // eslint-disable-next-line no-new-func
        const result = Function('"use strict"; return ('+expr+')')();
        calcOut.textContent = (Number.isFinite(result) ? result : 'Error');
      }catch{ calcOut.textContent='Error'; }
    }
    $('#calcEval').addEventListener('click', evaluate);
    calcExpr.addEventListener('keydown', e=>{ if(e.key==='Enter') evaluate(); });

    /** -----------------------------
     * 2. Unit Converter
     * ------------------------------ */
    const unitType = $('#unitType'), unitFrom=$('#unitFrom'), unitTo=$('#unitTo'), unitInput=$('#unitInput'), unitOut=$('#unitOut');
    const UNIT_MAP = {
      length: { base:'m', units:{
        m:1, km:1000, cm:0.01, mm:0.001, in:0.0254, ft:0.3048, yd:0.9144, mi:1609.344
      }},
      weight: { base:'g', units:{
        g:1, kg:1000, lb:453.59237, oz:28.349523125
      }},
      temperature: { base:'C', units:{ C:'C', F:'F', K:'K' } }
    };
    function fillUnits(){
      const type=unitType.value; const {units}=UNIT_MAP[type];
      const opts = Object.keys(units).map(u=>`<option value="${u}">${u}</option>`).join('');
      unitFrom.innerHTML = opts; unitTo.innerHTML = opts;
      unitFrom.value = Object.keys(units)[0]; unitTo.value = Object.keys(units)[1] || Object.keys(units)[0];
    }
    function convert(){
      const type=unitType.value, from=unitFrom.value, to=unitTo.value, val=parseFloat(unitInput.value);
      if(Number.isNaN(val)){ unitOut.textContent='Enter a value'; return;}
      let result;
      if(type!=='temperature'){
        const map=UNIT_MAP[type].units;
        result = val * map[from] / map[to];
      }else{
        // Convert temp via C
        let C;
        if(from==='C') C = val;
        if(from==='F') C = (val-32)*5/9;
        if(from==='K') C = val-273.15;
        if(to==='C') result = C;
        if(to==='F') result = C*9/5+32;
        if(to==='K') result = C+273.15;
      }
      unitOut.textContent = `${val} ${from} = ${(+result.toFixed(6)).toString()} ${to}`;
    }
    $('#unitConvert').addEventListener('click', convert);
    $('#unitSwap').addEventListener('click', ()=>{ const f=unitFrom.value; unitFrom.value=unitTo.value; unitTo.value=f; convert(); });
    unitType.addEventListener('change', ()=>{ fillUnits(); unitOut.textContent='—'; });
    fillUnits();

    /** -----------------------------
     * 3. Text Utilities
     * ------------------------------ */
    const textArea = $('#textInput'), textStats=$('#textStats');
    function stats(){
      const t=textArea.value;
      const words = (t.trim().match(/\S+/g)||[]).length;
      const chars = t.length;
      const lines = t.split(/\n/).length;
      textStats.textContent = `Words: ${words} • Characters: ${chars} • Lines: ${lines}`;
    }
    textArea.addEventListener('input', stats); stats();
    $('#toUpper').addEventListener('click', ()=>{ textArea.value = textArea.value.toUpperCase(); stats(); });
    $('#toLower').addEventListener('click', ()=>{ textArea.value = textArea.value.toLowerCase(); stats(); });
    $('#trimSpaces').addEventListener('click', ()=>{
      textArea.value = textArea.value.replace(/[ \t]+/g,' ').replace(/\s+\n/g,'\n').trim();
      stats();
    });
    $('#reverseText').addEventListener('click', ()=>{
      textArea.value = textArea.value.split('\n').reverse().join('\n');
      stats();
    });
    $('#wordCount').addEventListener('click', stats);
    $('#copyText').addEventListener('click', ()=> copyToClipboard(textArea.value));

    /** -----------------------------
     * 4. Base64 Encode/Decode (UTF-8 safe)
     * ------------------------------ */
    const b64In=$('#b64In'), b64Out=$('#b64Out');
    function utf8ToB64(str){ return btoa(unescape(encodeURIComponent(str))); }
    function b64ToUtf8(str){ return decodeURIComponent(escape(atob(str))); }
    $('#b64Encode').addEventListener('click', ()=>{ try{ b64Out.value = utf8ToB64(b64In.value); }catch{ b64Out.value='Error'; } });
    $('#b64Decode').addEventListener('click', ()=>{ try{ b64Out.value = b64ToUtf8(b64In.value); }catch{ b64Out.value='Error'; } });
    $('#b64Copy').addEventListener('click', ()=> copyToClipboard(b64Out.value));
    $('#b64Clear').addEventListener('click', ()=>{ b64In.value=''; b64Out.value=''; });

    /** -----------------------------
     * 5. URL Encode/Decode
     * ------------------------------ */
    $('#urlEncode').addEventListener('click', ()=> $('#urlOut').value = encodeURIComponent($('#urlIn').value));
    $('#urlDecode').addEventListener('click', ()=>{ try{ $('#urlOut').value = decodeURIComponent($('#urlIn').value);}catch{ $('#urlOut').value='Invalid encoding'; } });
    $('#urlCopy').addEventListener('click', ()=> copyToClipboard($('#urlOut').value));

    /** -----------------------------
     * 6. JSON Formatter/Validator
     * ------------------------------ */
    const jsonIn=$('#jsonIn'), jsonOut=$('#jsonOut');
    $('#jsonFormat').addEventListener('click', ()=>{
      try{ const obj=JSON.parse(jsonIn.value); jsonOut.textContent = JSON.stringify(obj,null,2); announce('JSON formatted'); }
      catch(e){ jsonOut.textContent = 'Error: '+e.message; }
    });
    $('#jsonMinify').addEventListener('click', ()=>{
      try{ const obj=JSON.parse(jsonIn.value); jsonOut.textContent = JSON.stringify(obj); announce('JSON minified'); }
      catch(e){ jsonOut.textContent = 'Error: '+e.message; }
    });
    $('#jsonValidate').addEventListener('click', ()=>{
      try{ JSON.parse(jsonIn.value); jsonOut.textContent = 'Valid JSON ✅'; }
      catch(e){ jsonOut.textContent = 'Invalid JSON ❌ — '+e.message; }
    });
    $('#jsonCopy').addEventListener('click', ()=> copyToClipboard(jsonOut.textContent));
    $('#jsonClear').addEventListener('click', ()=>{ jsonIn.value=''; jsonOut.textContent=''; });

    /** -----------------------------
     * 7. Password Generator
     * ------------------------------ */
    const passLen=$('#passLen'), passLenVal=$('#passLenVal'), passOut=$('#passOut');
    const sets = {
      lower: 'abcdefghijklmnopqrstuvwxyz',
      upper: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
      num:   '0123456789',
      sym:   '!@#$%^&*()_+-=[]{}|;:,.<>/?~',
    };
    function generatePassword(){
      const length = +passLen.value;
      const include = {
        lower: $('#passLower').checked,
        upper: $('#passUpper').checked,
        num: $('#passNum').checked,
        sym: $('#passSym').checked
      };
      let pool = '';
      for(const k in include) if(include[k]) pool += sets[k];
      if($('#passAmbig').checked) pool = pool.replace(/[O0Il|`'" ]/g,'');
      if(!pool){ passOut.value='Select at least one set'; return; }
      const arr = new Uint32Array(length);
      crypto.getRandomValues(arr);
      let pwd = '';
      for(let i=0;i<length;i++) pwd += pool[arr[i] % pool.length];
      passOut.value = pwd;
      passStrength.textContent = 'Strength: ' + estimateStrength(pwd);
    }
    function estimateStrength(pwd){
      // Simple estimator based on entropy bits ~ log2(pool^len)= len*log2(poolSize)
      const unique = new Set(pwd).size || 1;
      const bits = Math.round(pwd.length * Math.log2(unique));
      if(bits<40) return `Weak (${bits} bits)`;
      if(bits<60) return `Okay (${bits} bits)`;
      if(bits<80) return `Strong (${bits} bits)`;
      return `Very Strong (${bits}+ bits)`;
    }
    passLen.addEventListener('input', ()=> passLenVal.textContent = passLen.value);
    $('#passGen').addEventListener('click', generatePassword);
    $('#passCopy').addEventListener('click', ()=> copyToClipboard(passOut.value));
    // initial
    generatePassword();

    /** -----------------------------
     * 8. UUID v4
     * ------------------------------ */
    function uuidv4(){
      const bytes = new Uint8Array(16);
      crypto.getRandomValues(bytes);
      bytes[6] = (bytes[6] & 0x0f) | 0x40; // version 4
      bytes[8] = (bytes[8] & 0x3f) | 0x80; // variant 10
      const hex = [...bytes].map(b=>b.toString(16).padStart(2,'0'));
      return `${hex[0]}${hex[1]}${hex[2]}${hex[3]}-${hex[4]}${hex[5]}-${hex[6]}${hex[7]}-${hex[8]}${hex[9]}-${hex[10]}${hex[11]}${hex[12]}${hex[13]}${hex[14]}${hex[15]}`;
    }
    $('#uuidGen').addEventListener('click', ()=> $('#uuidOut').value = uuidv4());
    $('#uuidCopy').addEventListener('click', ()=> copyToClipboard($('#uuidOut').value));
    // initial
    $('#uuidOut').value = uuidv4();

    /** -----------------------------
     * 9. Hash Generator (SHA-256)
     * ------------------------------ */
    async function sha256(text){
      const enc = new TextEncoder();
      const hash = await crypto.subtle.digest('SHA-256', enc.encode(text));
      return [...new Uint8Array(hash)].map(b=>b.toString(16).padStart(2,'0')).join('');
    }
    $('#hashBtn').addEventListener('click', async ()=>{
      const input = $('#hashIn').value;
      $('#hashOut').value = 'Computing…';
      $('#hashOut').value = await sha256(input);
    });
    $('#hashCopy').addEventListener('click', ()=> copyToClipboard($('#hashOut').value));

    /** -----------------------------
     * 10. Image Resizer & Compressor (Canvas)
     * ------------------------------ */
    const imgFile=$('#imgFile'), imgW=$('#imgW'), imgH=$('#imgH'), imgQ=$('#imgQ'), imgType=$('#imgType'),
          imgLock=$('#imgLock'), imgCanvas=$('#imgCanvas'), imgMeta=$('#imgMeta'),
          imgPreviewSrc=$('#imgPreviewSrc'), imgPreviewOut=$('#imgPreviewOut');
    let original = new Image(), originalW=0, originalH=0, outputBlob=null;

    imgFile.addEventListener('change', async ()=>{
      const file = imgFile.files?.[0]; if(!file) return;
      const url = URL.createObjectURL(file);
      original = new Image();
      original.onload = ()=>{
        originalW = original.naturalWidth; originalH = original.naturalHeight;
        imgW.value = originalW; imgH.value = originalH;
        imgPreviewSrc.src = url; imgPreviewOut.src = '';
        imgMeta.textContent = `Original: ${file.type} • ${originalW}×${originalH} • ${(file.size/1024).toFixed(1)} KB`;
        URL.revokeObjectURL(url);
      };
      original.src = url;
    });
    imgW.addEventListener('input', ()=>{
      if(imgLock.checked && originalW>0){ imgH.value = Math.round(originalH * (imgW.value/originalW)); }
    });
    imgH.addEventListener('input', ()=>{
      if(imgLock.checked && originalH>0){ imgW.value = Math.round(originalW * (imgH.value/originalH)); }
    });
    $('#imgProcess').addEventListener('click', ()=>{
      if(!originalW){ toast('Choose an image'); return; }
      const w = Math.max(1, +imgW.value|0), h = Math.max(1, +imgH.value|0);
      const type = imgType.value, q = parseFloat(imgQ.value);
      imgCanvas.width = w; imgCanvas.height = h;
      const ctx = imgCanvas.getContext('2d');
      ctx.clearRect(0,0,w,h);
      ctx.drawImage(original, 0, 0, w, h);
      imgCanvas.toBlob((blob)=>{
        outputBlob = blob;
        imgPreviewOut.src = URL.createObjectURL(blob);
        imgMeta.textContent += ` • Output: ${type} • ${w}×${h} • ${blob ? (blob.size/1024).toFixed(1) : '?'} KB`;
        $('#imgDownload').disabled = !blob;
      }, type, type==='image/png' ? undefined : q);
    });
    $('#imgDownload').addEventListener('click', ()=>{
      if(!outputBlob) return;
      const a = document.createElement('a');
      a.download = `tools-pack.${imgType.value.split('/')[1]}`;
      a.href = URL.createObjectURL(outputBlob);
      a.click();
      setTimeout(()=> URL.revokeObjectURL(a.href), 1000);
    });

    /** -----------------------------
     * 11. Color Picker + Contrast Checker (WCAG)
     * ------------------------------ */
    const fgColor=$('#fgColor'), bgColor=$('#bgColor'), contrastOut=$('#contrastOut'), contrastPreview=$('#contrastPreview');
    function hexToRgb(hex){
      hex = hex.replace('#','');
      if(hex.length===3) hex = hex.split('').map(c=>c+c).join('');
      const num = parseInt(hex,16);
      return [ (num>>16)&255, (num>>8)&255, num&255 ];
    }
    function luminance([r,g,b]){
      const a=[r,g,b].map(v=>{
        v/=255;
        return v<=0.03928? v/12.92 : Math.pow((v+0.055)/1.055,2.4);
      });
      return 0.2126*a[0]+0.7152*a[1]+0.0722*a[2];
    }
    function contrastRatio(fg,bg){
      const L1 = luminance(hexToRgb(fg))+0.05;
      const L2 = luminance(hexToRgb(bg))+0.05;
      const ratio = L1>L2 ? L1/L2 : L2/L1;
      return Math.round(ratio*100)/100;
    }
    function updateContrast(){
      const fg=fgColor.value, bg=bgColor.value, r=contrastRatio(fg,bg);
      contrastPreview.style.color = fg; contrastPreview.style.background = bg;
      $('#sampleText').textContent = `Aa — Sample Text (${fg.toUpperCase()} on ${bg.toUpperCase()})`;
      const passNormal = r>=4.5 ? 'Pass' : (r>=3 ? 'AA Large only' : 'Fail');
      const passAAA = r>=7 ? 'AAA' : (r>=4.5 ? 'AA' : '—');
      contrastOut.innerHTML = `Contrast: <b>${r}:1</b> • WCAG: <b>${passAAA}</b> (${passNormal})`;
    }
    fgColor.addEventListener('input', updateContrast);
    bgColor.addEventListener('input', updateContrast);
    updateContrast();

    /** -----------------------------
     * 12. Stopwatch & Countdown
     * ------------------------------ */
    const swDisplay=$('#stopwatchDisplay'), swStart=$('#swStart'), swStop=$('#swStop'), swReset=$('#swReset'), swLap=$('#swLap'), swLaps=$('#swLaps');
    let swStartTs=0, swElapsed=0, swTimer=null, laps=[];
    function fmtMs(ms){
      const m = Math.floor(ms/60000).toString().padStart(2,'0');
      const s = Math.floor((ms%60000)/1000).toString().padStart(2,'0');
      const cs = Math.floor((ms%1000)/10).toString().padStart(2,'0');
      return `${m}:${s}.${cs}`;
    }
    function tick(){
      const now = performance.now();
      swDisplay.textContent = fmtMs(swElapsed + (now - swStartTs));
      swTimer = requestAnimationFrame(tick);
    }
    swStart.addEventListener('click', ()=>{
      if(swTimer) return;
      swStartTs = performance.now();
      swTimer = requestAnimationFrame(tick);
    });
    swStop.addEventListener('click', ()=>{
      if(!swTimer) return;
      cancelAnimationFrame(swTimer); swTimer=null;
      swElapsed += performance.now() - swStartTs;
      swDisplay.textContent = fmtMs(swElapsed);
    });
    swReset.addEventListener('click', ()=>{
      if(swTimer){ cancelAnimationFrame(swTimer); swTimer=null; }
      swElapsed=0; laps=[]; swDisplay.textContent='00:00.00'; swLaps.textContent='Laps: —';
    });
    swLap.addEventListener('click', ()=>{
      const t = swTimer ? fmtMs(swElapsed + (performance.now()-swStartTs)) : fmtMs(swElapsed);
      laps.push(t);
      swLaps.textContent = 'Laps: ' + laps.map((l,i)=>`#${i+1} ${l}`).join(' • ');
    });

    // Countdown
    const cdMin=$('#cdMin'), cdSec=$('#cdSec'), cdStart=$('#cdStart'), cdPause=$('#cdPause'), cdReset=$('#cdReset'), cdDisplay=$('#countdownDisplay');
    let cdRemaining=0, cdInterval=null;
    function updateCdDisplay(){
      const m = Math.floor(cdRemaining/60).toString().padStart(2,'0');
      const s = Math.floor(cdRemaining%60).toString().padStart(2,'0');
      cdDisplay.textContent = `${m}:${s}`;
    }
    cdStart.addEventListener('click', ()=>{
      if(cdInterval) return;
      if(cdRemaining<=0){
        cdRemaining = (+cdMin.value|0)*60 + (+cdSec.value|0);
      }
      if(cdRemaining<=0){ toast('Set a time'); return; }
      cdInterval = setInterval(()=>{
        cdRemaining--;
        updateCdDisplay();
        if(cdRemaining<=0){
          clearInterval(cdInterval); cdInterval=null;
          updateCdDisplay();
          try{ new AudioContext().resume().then(()=>{}); }catch{}
          // Simple beep
          const ctx = new (window.AudioContext||window.webkitAudioContext)();
          const o = ctx.createOscillator(); const g = ctx.createGain();
          o.type='sine'; o.frequency.value=880; o.connect(g); g.connect(ctx.destination);
          g.gain.setValueAtTime(0.001, ctx.currentTime);
          g.gain.exponentialRampToValueAtTime(0.2, ctx.currentTime+.02);
          o.start();
          setTimeout(()=>{ g.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime+.2); o.stop(ctx.currentTime+.25); }, 230);
          toast('Time’s up!');
        }
      },1000);
    });
    cdPause.addEventListener('click', ()=>{ if(cdInterval){ clearInterval(cdInterval); cdInterval=null; } });
    cdReset.addEventListener('click', ()=>{ if(cdInterval){ clearInterval(cdInterval); cdInterval=null; } cdRemaining=0; updateCdDisplay(); });
    updateCdDisplay();

    /** -----------------------------
     * 13. Quick Notes (localStorage)
     * ------------------------------ */
    const notesKey='toolspack.notes.v1', notesTitle=$('#notesTitle'), notesArea=$('#notesArea'), notesSaved=$('#notesSaved');
    function saveNotes(){
      const data = { title: notesTitle.value, content: notesArea.value, ts: Date.now() };
      localStorage.setItem(notesKey, JSON.stringify(data));
      notesSaved.textContent = 'Saved • '+ new Date(data.ts).toLocaleString();
    }
    function loadNotes(){
      try{
        const str=localStorage.getItem(notesKey);
        if(!str) return;
        const data=JSON.parse(str);
        notesTitle.value = data.title||''; notesArea.value=data.content||'';
        notesSaved.textContent = 'Loaded • '+ new Date(data.ts).toLocaleString();
      }catch{}
    }
    notesTitle.addEventListener('input', ()=>{ saveNotes(); });
    notesArea.addEventListener('input', ()=>{ saveNotes(); });
    $('#notesExport').addEventListener('click', ()=>{
      const blob = new Blob([localStorage.getItem(notesKey)||'{}'], {type:'application/json'});
      const a = document.createElement('a'); a.download='tools-pack-notes.json'; a.href=URL.createObjectURL(blob); a.click();
      setTimeout(()=> URL.revokeObjectURL(a.href), 1000);
    });
    $('#notesImport').addEventListener('change', ()=>{
      const file = $('#notesImport').files?.[0]; if(!file) return;
      const reader = new FileReader();
      reader.onload = ()=>{ try{
        const data = JSON.parse(reader.result);
        if(!('content' in data)){ toast('Invalid file'); return; }
        localStorage.setItem(notesKey, JSON.stringify(data));
        loadNotes();
        toast('Imported');
      }catch{ toast('Invalid file'); } };
      reader.readAsText(file);
    });
    $('#notesClear').addEventListener('click', ()=>{
      if(confirm('Clear notes?')){ localStorage.removeItem(notesKey); notesTitle.value=''; notesArea.value=''; notesSaved.textContent='Cleared.'; }
    });
    loadNotes();

    /** -----------------------------
     * Accessibility and polish
     * ------------------------------ */
    // Focus outlines on keyboard only
    function handleFirstTab(e){ if(e.key==='Tab'){ document.body.classList.add('user-is-tabbing'); window.removeEventListener('keydown', handleFirstTab); } }
    window.addEventListener('keydown', handleFirstTab);
    // Smooth anchor focus highlight
    const style = document.createElement('style');
    style.textContent = `.highlight{outline:2px solid var(--accent); box-shadow: var(--focus) !important}`;
    document.head.appendChild(style);
  })();
  </script>
</body>
</html>
